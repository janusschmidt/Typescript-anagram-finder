<html>
<head>
    <title>find kaninen</title>
    <script src="http://crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/md5.js"></script>
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script>
        $(function () {
            var phrase = 'poultry outwits ants';
            var md5hashtofind = '4624d200580677270a54ccff86b9610e';
            var OKchars = phrase.replace(/ /g, '').split('');
            var noOfCharsInAnagram = OKchars.length;
            var ord, ord1, ord2, tmp, tmp1, tmp2;
            var annagrammerDiv = $('#anagrammer');

            //check om et ord eller anagram ikke indeholder forkerte eller for mange af en slags bogstaver
            var charsOk = function (str) {
                var i=0, pos;
                var res = true;
                var okcharstmp = OKchars.slice();
                var c;
                chars = str.split('');

                if (str.length === 0) {
                    return false;
                }

                while (c = chars.pop()) {
                    //ignore whitespace
                    if (c == ' ' || c == '\r' || c == '\n') {
                        continue;
                    }

                    i = okcharstmp.indexOf(c);
                    if (i>-1) {
                        okcharstmp.splice(i,1);
                    } else {
                        res = false;
                        break;
                    }
                }
                return res;
            }

            //check om et anagram er ok og om det har den ønskede md5 hash værdi
            //printer resultatet hvis det er et gyldigt anagram
            var isAnagram = function (wordsInAnagram) {
                var stringtocheck = wordsInAnagram.join('');
                var stringtocheckWithSpaces = wordsInAnagram.join(' ');
                //er det et anagram?
                if ((stringtocheck.length == noOfCharsInAnagram) && charsOk(stringtocheck)) {
                    //har det den rette hash
                    if (md5hashtofind == CryptoJS.MD5(stringtocheckWithSpaces).toString(CryptoJS.enc.Hex)) {
                        annagrammerDiv.append('<div style="background-color:green;font-size:xx-large;">' + stringtocheckWithSpaces + '</div>');
                    }
                    else {
                        annagrammerDiv.append('<div style="background-color:red">' + stringtocheckWithSpaces + '</div>');
                    }
                    return true;
                }
                return false;
            }

            function getAnagrams(maxNoWordsInAnagram, wordsToTry, wordsInAnagram) {
                var tmp, tryWordsInAnagram;
                if (maxNoWordsInAnagram > 0 && wordsToTry.length > 0) {
                    tmp = wordsToTry.slice();
                    do {
                        tryWordsInAnagram = wordsInAnagram.slice();
                        tryWordsInAnagram.push(tmp[0]);
                        if (!isAnagram(tryWordsInAnagram) && tryWordsInAnagram.join('').length < noOfCharsInAnagram) {
                            //forsøg at kombinere med flere ord via rekursion, hvis de ord der forsøges med nu ikke er for lange
                            getAnagrams(maxNoWordsInAnagram - 1, wordsToTry.slice(), tryWordsInAnagram)
                        }
                    } while (tmp.shift())
                }
            }

            $.get('wordlist.txt').done(function (data) {
                //Først konstrueres en positiv liste af engelske ord
                var i, oklistwords = [], sb;
                list = data.split('\n');
                for (i = 0; i < list.length; i++) {
                    var word = list[i].replace(/\s/g, '');
                    if (charsOk(word)) {
                        oklistwords.push(word);
                    }
                }
                $('#antalokord').text(oklistwords.length);

                //start rekursion
                getAnagrams(3, oklistwords, []);
                $('#done').show();
                
                ////anagrammer med 1 ord
                //tmp = oklistwords.slice();
                //found: while (ord = tmp.pop()) {
                //    if (isAnagram(ord)) {
                //        break found;
                //    }
                //}
                
                ////anagrammer med 2 ord
                //tmp = oklistwords.slice();
                //found: while (ord = tmp.pop()) {
                //    tmp1 = oklistwords.slice();
                //    while (ord1 = tmp1.pop()) {
                //        if (isAnagram([ord, ord1])) {
                //            break found;
                //        }
                //    }
                //}

                //////anagrammer med 3 ord
                //tmp = oklistwords.slice();
                //found: while (ord = tmp.pop()) {
                //    tmp1 = oklistwords.slice();
                //    while (ord1 = tmp1.pop()) {
                //        tmp2 = oklistwords.slice();
                //        while (ord2 = tmp2.pop()) {
                //            if (isAnagram(ord + ' ' + ord1 + ' ' + ord2)) {
                //                break found;
                //            }
                //        }
                //    }
                //}
            });
        });
    </script>
</head>
<body>
    <div>antal positiv ord:<span id="antalokord"></span></div>
    <h1>Anagrammer</h1>
    <div id="anagrammer"></div>
    <div id="done" style="display:none;">Færdig</div>
</body>

</html>